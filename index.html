<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindana - Katalog Pencari Jodoh</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
	<style>
        :root {
            --primary-color: #8b5a2b;
            --secondary-color: #d4a76a;
            --accent-color: #f1e6d6;
            --text-dark: #3a2c1a;
            --text-light: #7a6a53;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text-dark);
            background-color: #f9f7f3;
        }
		
		
		
        .logo {
			font-family: 'Great Vibes', cursive; /* Font sambung estetik */
			font-size: 3rem; /* Ukuran diperbesar agar lekukannya terlihat jelas */
			font-weight: 400;  /* Great Vibes tidak butuh bold */
			
			/* --- Efek Warna Gradasi (Emas ke Coklat) --- */
			background: linear-gradient(45deg, #8b5a2b, #d4a76a, #8b5a2b);
			background-size: 200% auto;
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
			color: transparent;
			
			/* --- Efek Shadow/Bayangan --- */
			/* Menggunakan filter drop-shadow karena text-shadow tidak jalan di text transparan */
			filter: drop-shadow(2px 2px 2px rgba(139, 90, 43, 0.2));
			
			text-decoration: none;
			transition: all 0.5s ease;
			padding-bottom: 5px; /* Sedikit ruang agar buntut huruf 'g' atau 'j' tidak terpotong */
		}

		/* Efek saat mouse diarahkan ke logo (Mengkilap) */
		.logo:hover {
			background-position: right center; /* Menggerakkan gradasi warna */
			filter: drop-shadow(3px 3px 4px rgba(139, 90, 43, 0.4)); /* Shadow makin tegas */
			transform: scale(1.05); /* Sedikit membesar */
		}

		/* Hapus style span lama jika ada, biar tidak menabrak */
		.logo span {
			color: inherit;
			-webkit-text-fill-color: inherit;
		}
		
		
		
        .navbar {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 15px 0;
        }
        
        
        
        .search-section {
            background-color: white;
            padding: 30px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .search-bar {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .search-bar .form-control {
            border-radius: 30px;
            padding: 12px 25px;
            border: 1px solid var(--secondary-color);
        }
        
        .search-bar .btn {
            border-radius: 30px;
            background-color: var(--primary-color);
            color: white;
            padding: 12px 25px;
        }
        
        .biodata-count {
            font-weight: 600;
            color: var(--primary-color);
            font-size: 1.1rem;
            text-align: center;
            margin-top: 15px;
        }
        
        .hero-banner {
			position: relative; /* Penting untuk container */
			overflow: hidden;   /* Agar video tidak keluar batas */
			padding: 200px 0;
			text-align: center;
			color: white;
			/* Background image lama dihapus/tidak dipakai lagi */
		}
		.video-bg {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			object-fit: cover; /* Agar video full screen dan tidak gepeng */
			z-index: 0;        /* Paling belakang */
		}

		/* Class baru untuk Lapisan Gelap (Overlay) agar teks terbaca */
		.hero-overlay {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(139, 90, 43, 0.7); /* Warna coklat transparan (sesuai tema) */
			/* Atau gunakan rgba(0,0,0,0.6) untuk hitam transparan */
			z-index: 1; /* Di atas video */
		}

		/* Class baru untuk Konten Teks */
		.hero-content {
			position: relative;
			z-index: 2; /* Paling depan (di atas video & overlay) */
		}
        
        .hero-banner h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .hero-banner p {
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto 30px;
        }
        
        .btn-primary-custom {
            background-color: var(--secondary-color);
            border: none;
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        
        .btn-primary-custom:hover {
            background-color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .section-title {
            text-align: center;
            margin: 60px 0 40px;
            color: var(--primary-color);
            font-weight: 700;
            position: relative;
        }
        
        .section-title:after {
            content: '';
            display: block;
            width: 80px;
            height: 3px;
            background-color: var(--secondary-color);
            margin: 10px auto;
        }
        
        .card-biodata {
            border: none;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: all 0.3s;
            margin-bottom: 25px;
            height: 100%;
        }
        
        .card-biodata:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.12);
        }
        
        .card-img-top {
            height: 400px;
            object-fit: cover;
            border-bottom: 2px solid var(--secondary-color);
        }
        
        .card-body {
            padding: 15px;
        }
        
        .card-title {
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .card-text {
            color: var(--text-light);
            margin-bottom: 12px;
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        .biodata-details {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .biodata-details li {
            margin-bottom: 6px;
            font-size: 0.8rem;
        }
        
        .biodata-details li i {
            color: var(--secondary-color);
            width: 16px;
            margin-right: 5px;
        }
        
        .btn-outline-custom {
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            border-radius: 20px;
            padding: 6px 15px;
            font-weight: 600;
            transition: all 0.3s;
            width: 100%;
            font-size: 0.85rem;
        }
        
        .btn-outline-custom:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        footer {
            background-color: var(--primary-color);
            color: white;
            padding: 40px 0 20px;
            margin-top: 60px;
        }
        
        .footer-logo {
            font-weight: 700;
            font-size: 1.8rem;
            margin-bottom: 20px;
        }
        
        .footer-links h5 {
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--accent-color);
        }
        
        .footer-links ul {
            list-style: none;
            padding: 0;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: #ddd;
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        .copyright {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #ddd;
            font-size: 0.9rem;
        }
        
        /* Filter Section */
        .filter-section {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        
        .filter-title {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .form-label {
            font-weight: 500;
            color: var(--text-dark);
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .hero-banner {
                padding: 60px 0;
            }
            
            .hero-banner h1 {
                font-size: 2.2rem;
            }
        }
        
        @media (max-width: 576px) {
            .card-img-top {
                height: 460px;
            }
        }
		
		/* --- TAMBAHAN CUSTOM WARNA BADGE --- */
		.badge-pink {
			background-color: #d63384 !important; /* Pink Bootstrap */
			color: white;
		}
		.badge-ungu {
			background-color: #6f42c1 !important; /* Ungu Bootstrap */
			color: white;
		}
		.badge-oranye {
			background-color: #fd7e14 !important; /* Orange Bootstrap */
			color: white;
		}
		/* Memastikan badge terlihat rapi */
		.badge {
			font-weight: 5000;
			letter-spacing: 0.5px;
		}
		
		/* --- STYLE UNTUK ZOOM FOTO --- */
		/* Wadah Hitam Fullscreen */
		#imageViewer {
			display: none; /* Default tersembunyi */
			position: fixed;
			z-index: 10000; /* Harus lebih tinggi dari Modal Bootstrap (1055) */
			padding-top: 50px;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			overflow: auto;
			background-color: rgba(0,0,0,0.95); /* Latar hitam pekat */
			cursor: zoom-out; /* Kursos berubah jadi tanda minus */
		}

		/* Gambar yang diperbesar */
		.modal-content-zoom {
			margin: auto;
			display: block;
			max-width: 90%;
			max-height: 90vh; /* Agar tidak melebihi tinggi layar */
			object-fit: contain;
			border-radius: 5px;
			box-shadow: 0 0 20px rgba(255,255,255,0.2);
			animation-name: zoomEffect;
			animation-duration: 0.3s;

		}

		/* Tombol Close (X) */
		.close-zoom {
			position: absolute;
			top: 15px;
			right: 35px;
			color: #f1f1f1;
			font-size: 40px;
			font-weight: bold;
			transition: 0.3s;
			cursor: pointer;
		}

		.close-zoom:hover {
			color: #bbb;
		}

		/* Animasi Zoom In */
		@keyframes zoomEffect {
			from {transform:scale(0.8); opacity: 0} 
			to {transform:scale(1); opacity: 1}
		}

		/* Ubah kursor foto di dalam modal detail jadi pointer (tangan) */
		#detailFoto {
			cursor: zoom-in;
			transition: transform 0.2s;
		}
		#detailFoto:hover {
			opacity: 0.9;
		}
		
		/* --- CSS UNTUK HOVER GAMBAR DI MODAL --- */
		.image-container-modal {
			position: relative;
			display: inline-block; /* Agar container pas dengan ukuran gambar */
			cursor: zoom-in;
			border-radius: 5px;
			overflow: hidden; /* Agar overlay tidak keluar dari sudut yang membulat */
		}

		.overlay-zoom-text {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.6); /* Latar hitam transparan */
			color: white;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			opacity: 0; /* Default tidak terlihat */
			transition: opacity 0.3s ease;
			font-weight: 500;
			text-align: center;
		}

		/* Saat container di-hover, overlay jadi terlihat */
		.image-container-modal:hover .overlay-zoom-text {
			opacity: 1;
		}


		/* --- UPDATE & TAMBAHAN CSS ZOOM --- */

		/* Container Zoom Controls */
		.zoom-controls {
			position: fixed;
			bottom: 30px;
			left: 50%;
			transform: translateX(-50%);
			display: flex;
			align-items: center;
			gap: 15px;
			background-color: rgba(255, 255, 255, 0.9);
			padding: 10px 20px;
			border-radius: 50px;
			box-shadow: 0 4px 15px rgba(0,0,0,0.5);
			z-index: 10002;
		}

		/* Tombol + dan - */
		.btn-zoom {
			background: var(--primary-color);
			color: white;
			border: none;
			width: 35px;
			height: 35px;
			border-radius: 50%;
			cursor: pointer;
			display: flex;
			align-items: center;
			justify-content: center;
			transition: 0.2s;
		}

		.btn-zoom:hover {
			background-color: var(--secondary-color);
			transform: scale(1.1);
		}

		/* Slider (Range Input) */
		#zoomSlider {
			width: 200px;
			cursor: pointer;
			accent-color: var(--primary-color); /* Warna slider mengikuti tema */
		}

		/* Agar gambar bisa dizoom dengan lancar */
		.modal-content-zoom {
			/* ... property lama tetap ada ... */
			transition: transform 0.1s ease-out; /* Animasi halus saat slider digeser */
			transform-origin: center center;
			cursor: grab; /* Ubah kursor jadi tangan */
		}

		/* Responsive di HP: Slider lebih pendek */
		@media (max-width: 576px) {
			#zoomSlider {
				width: 120px;
			}
			.zoom-controls {
				bottom: 80px; /* Naik sedikit agar tidak kena tombol navigasi HP */
			}
		}
		
		
		
		/* --- CSS UNTUK LOGIN GATE --- */
		#loginGate {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: linear-gradient(135deg, #3a2c1a 0%, #1a120b 100%); /* Warna gelap elegan */
			z-index: 20000; /* Paling atas, di atas Zoom & Modal */
			overflow-y: auto; /* Agar bisa discroll di HP jika layar pendek */
			padding: 20px 0;
		}

		.login-card {
			border: none;
			border-radius: 15px;
			box-shadow: 0 10px 30px rgba(0,0,0,0.3);
			transition: transform 0.3s;
			background-color: rgba(255, 255, 255, 0.95);
		}

		.login-card:hover {
			transform: translateY(-5px);
		}

		/* Class tambahan untuk mematikan scroll website utama */
		body.locked {
			overflow: hidden;
		}
		
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand logo" href="#">Mindana</a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarContent">
                <div class="ms-auto d-flex align-items-center">
                    <div class="biodata-count">
                        <i class="fas fa-users me-2"></i> <span id="totalBiodata">0</span> Biodata Tersedia
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Banner -->
    <section class="hero-banner">
		<video autoplay muted loop playsinline class="video-bg">
			<source src="video.mp4" type="video/mp4">
			Browser Anda tidak mendukung tag video.
		</video>

		<div class="hero-overlay"></div>

		<div class="container hero-content">
			<h1>Menumbuhkan Iman, Menyambut Pendamping Idaman</h1>
			<p>Platform pencarian jodoh dengan nilai-nilai islami untuk menemukan pasangan hidup yang tepat dan barokah</p>
			<a href="#katalog" class="btn btn-primary-custom">Lihat Katalog <i class="fas fa-arrow-down ms-2"></i></a>
		</div>
	</section>

    <!-- Search Section -->
    <section class="search-section">
        <div class="container">
            
            <div class="biodata-count">
                Menampilkan <span id="displayedBiodata">0</span> dari <span id="totalBiodata2">0</span> Biodata
            </div>
        </div>
    </section>

    <!-- Filter Section -->
    <section class="container mt-5">
        <div class="filter-section">
            <h4 class="filter-title">Filter Pencarian</h4>
            <div class="row">
				<div class="search-bar">
					<div class="input-group">
						<input type="text" class="form-control" id="searchInput" placeholder="Cari Nama, Warna, Daerah, atau Pekerjaan">
						<button class="btn" type="button" onclick="searchBiodata()"><i class="fas fa-search"></i></button>
					</div>
				</div>
			</div>
			<div class="row mt-4">
                <div class="col-md-3 mb-3">
                    <label class="form-label">Jenis Kelamin</label>
                    <select class="form-select" id="genderFilter">
                        <option value="all" selected>Semua</option>
                        <option value="Laki-Laki">Laki-laki</option>
                        <option value="Perempuan">Perempuan</option>
                    </select>
                </div>
                
                <div class="col-md-3 mb-3">
                    <label class="form-label">Lokasi</label>
                    <select class="form-select" id="locationFilter">
                        <option value="all" selected>Semua Daerah</option>
                        <option value="Blora">Blora</option>
						<option value="Rembang">Rembang</option>
                        <option value="Pati 1">Pati 1</option>
						<option value="Pati 2">Pati 2</option>
						<option value="Kudus">Kudus</option>
						<option value="Jepara">Jepara</option>
						<option value="Demak">Demak</option>
						<option value="Grobogan">Grobogan</option>
                        <option value="Tuban">Tuban</option>
                    </select>
                </div>
                <div class="col-md-3 mb-3">
                    <label class="form-label">Pendidikan</label>
                    <select class="form-select" id="educationFilter">
						<option value="all" selected>Semua Pendidikan</option>
                        <option value="SD/Sederajat">SD/Sederajat</option>
						<option value="SMP/Sederajat">SMP/Sederajat</option>
						<option value="SMA/Sederajat">SMA/Sederajat</option>
						<option value="SMK">SMK</option>
						<option value="D1/D2/D3">D1 / D2 / D3</option>
						<option value="D4">D4</option>
						<option value="S1">S1</option>
						<option value="S2">S2</option>
						<option value="others">Lainnya</option>
                    </select>
                </div>
				<div class="col-md-3 mb-3">
					<label class="form-label">Tahun Kelahiran</label>
					<select class="form-select" id="yearFilter">
						<option value="all" selected>Semua Tahun</option>
						<option value="1950-1960">1950 - 1960</option>
						<option value="1960-1970">1960 - 1970</option>
						<option value="1970-1980">1970 - 1980</option>
						<option value="1980-1990">1980 - 1990</option>
						<option value="1990-2000">1990 - 2000</option>
						<option value="2000-2010">2000 - 2010</option>
					</select>
				</div>
            </div>
        </div>
    </section>

    <!-- Katalog Biodata -->
    <section id="katalog" class="container">
        <h2 class="section-title">Katalog Pencari Jodoh</h2>
        <div class="d-flex justify-content-end mb-3">
			<label class="me-2">Tampilkan:</label>
			<select id="itemsPerPage" class="form-select w-auto">
				<option value="10">10</option>
				<option value="20" selected>20</option>
				<option value="40">40</option>
				<option value="50">50</option>
			</select>
		</div>
        <div class="row" id="biodataContainer">
            <!-- Biodata akan diisi oleh JavaScript -->
        </div>
        
        <!-- Pagination -->
        <nav aria-label="Page navigation" class="mt-5">
            <ul class="pagination justify-content-center">
                <li class="page-item disabled">
                    <a class="page-link" href="#" tabindex="-1">Previous</a>
                </li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item">
                    <a class="page-link" href="#">Next</a>
                </li>
            </ul>
        </nav>
    </section>
	
	
	
	<!-- Modal Detail Biodata -->
	<div class="modal fade" id="detailModal" tabindex="-1" aria-labelledby="detailModalLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg modal-dialog-centered">
		<div class="modal-content">
		  <div class="modal-header">
			<h5 class="modal-title" id="detailModalLabel">Detail Biodata</h5>
			<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		  </div>
		  <div class="modal-body">
			<div class="row">
			  <div class="col-md-4 text-center mb-3">
				<div class="image-container-modal" id="imageContainerBtn">
					<img id="detailFoto" src="" alt="Foto" class="img-fluid rounded" style="max-height:800px; object-fit:cover;">
					<div class="overlay-zoom-text">
						<i class="fas fa-search-plus fa-2x mb-2"></i><br>
						Klik untuk memperjelas
					</div>
				</div>
			  </div>
			  <div class="col-md-8">
				<ul class="list-group list-group-flush" id="detailList"></ul>
			  </div>
			</div>
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
		  </div>
		</div>
	  </div>
	</div>
	
	
    <!-- FOTO POPUP -->
	<div id="imageViewer">
		<span class="close-zoom" onclick="closeZoom()">&times;</span>
		
		<img class="modal-content-zoom" id="expandedImg">

		<div class="zoom-controls" onclick="event.stopPropagation()">
			<button class="btn-zoom" onclick="updateZoom(-0.2)"><i class="fas fa-minus"></i></button>
			<input type="range" id="zoomSlider" min="1" max="3.5" step="0.1" value="1">
			<button class="btn-zoom" onclick="updateZoom(0.2)"><i class="fas fa-plus"></i></button>
		</div>
	</div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <div class="footer-logo">Mindana</div>
                    <p>Menumbuhkan Iman, Menyambut Pendamping Idaman. Platform pencarian jodoh dengan nilai-nilai islami untuk menemukan pasangan hidup yang tepat dan barokah.</p>
                </div>
                <div class="col-lg-2 col-md-6 mb-4">
                    <div class="footer-links">
                        <h5>Tautan Cepat</h5>
                        <ul>
                            <li><a href="#">Beranda</a></li>
                            <li><a href="#katalog">Katalog</a></li>

                        </ul>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="footer-links">
                        <h5>Bantuan</h5>
                        <ul>
                            <li><a href="https://wa.me/628995858647" target="_blank">Hubungi Kami</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-lg-3 mb-4">
                    <div class="footer-links">
                        <h5>Kontak</h5>
                        <ul>
                            <li><i class="fas fa-map-marker-alt me-2"></i> Jl. Cendrawasih, Nglobener, Jepon, Kec. Jepon, Kabupaten Blora, Jawa Tengah 58261</li>
                            <li><i class="fas fa-phone me-2"></i>+62 823-9103-8122</li>
                            <li><i class="fas fa-envelope me-2"></i> project.jokam@gmail.com</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="copyright">
                &copy; 2025 PnKB Blora. All rights reserved.
            </div>
        </div>
    </footer>
	
	<div id="loginGate">
		<div class="container h-100">
			<div class="row h-100 justify-content-center align-items-center">
				<div class="col-12 text-center mb-5">
					<h1 class="logo text-white mb-3" style="font-size: 3.5rem;">Mindana</h1>
					<p class="text-white fs-5">Silakan masukkan token akses sesuai kategori Anda</p>
				</div>

				<div class="col-lg-4 col-md-6 col-12 mb-4">
					<div class="card login-card h-100">
						<div class="card-body text-center">
							<i class="fas fa-male fa-3x text-primary mb-3"></i>
							<h4 class="card-title">Ikhwan</h4>
							<p class="card-text small text-muted">Untuk melihat biodata Akhwat</p>
							<input type="password" id="tokenIkhwan" class="form-control text-center mb-3" placeholder="Token Ikhwan">
							<button class="btn btn-primary w-100" onclick="attemptLogin('ikhwan')">Masuk</button>
						</div>
					</div>
				</div>

				<div class="col-lg-4 col-md-6 col-12 mb-4">
					<div class="card login-card h-100">
						<div class="card-body text-center">
							<i class="fas fa-female fa-3x text-danger mb-3"></i>
							<h4 class="card-title">Akhwat</h4>
							<p class="card-text small text-muted">Untuk melihat biodata Ikhwan</p>
							<input type="password" id="tokenAkhwat" class="form-control text-center mb-3" placeholder="Token Akhwat">
							<button class="btn btn-danger w-100" onclick="attemptLogin('akhwat')">Masuk</button>
						</div>
					</div>
				</div>

				<div class="col-lg-4 col-md-6 col-12 mb-4">
					<div class="card login-card h-100">
						<div class="card-body text-center">
							<i class="fas fa-users-cog fa-3x text-success mb-3"></i>
							<h4 class="card-title">Tim PNKB</h4>
							<p class="card-text small text-muted">Akses penuh semua data</p>
							<input type="password" id="tokenPnkb" class="form-control text-center mb-3" placeholder="Token PNKB">
							<button class="btn btn-success w-100" onclick="attemptLogin('pnkb')">Masuk Tim PnKB</button>
						</div>
					</div>
				</div>
				
				<div class="col-12 text-center text-white-50 mt-4">
					<small>&copy; 2025 PnKB Blora. All rights reserved.</small>
				</div>
			</div>
		</div>
	</div>
	
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
	<script src="biodata.js"></script>

	<script>
		// ==================================================
		// 1. VARIABLES & CONFIGURATION
		// ==================================================
		let filteredData = (typeof biodata !== 'undefined') ? biodata : [];
		let currentPage = 1;
		let itemsPerPage = 20;
		
		// Variabel Hak Akses (Token)
		let userTargetGender = null; // 'Perempuan', 'Laki-Laki', atau 'ALL'

		// Variabel Zoom & Drag
		let currentZoom = 1;
		let isDragging = false;
		let startX, startY;
		let translateX = 0, translateY = 0;


		// ==================================================
		// 2. HELPER FUNCTIONS
		// ==================================================
		
		// Extract Tahun dari TTL
		function extractYear(ttl) {
			if (!ttl) return 0;
			const match = ttl.match(/\b(19|20)\d{2}\b/);
			return match ? parseInt(match[0]) : 0;
		}

		// Convert Link Google Drive
		function convertDriveLink(url) {
			if (!url) return 'https://via.placeholder.com/400x400?text=No+Image';
			if (url.includes("drive.google.com")) {
				const id = url.split("id=")[1] || url.split("/d/")[1]?.split("/")[0];
				return `https://drive.google.com/thumbnail?id=${id}&sz=w1000`;
			}
			return url;
		}

		// Convert Warna ke Class Bootstrap/Custom
		function getColorClass(colorName) {
			if (!colorName) return "bg-secondary";
			const lower = colorName.toLowerCase();
			if (lower.includes("pink") || lower.includes("muda")) return "badge-pink";
			if (lower.includes("merah")) return "bg-danger";
			if (lower.includes("oranye") || lower.includes("orange")) return "badge-oranye";
			if (lower.includes("kuning")) return "bg-warning text-dark";
			if (lower.includes("hijau")) return "bg-success";
			if (lower.includes("biru")) return "bg-primary";
			if (lower.includes("ungu") || lower.includes("purple")) return "badge-ungu";
			if (lower.includes("hitam")) return "bg-dark";
			return "bg-secondary";
		}

		// Acak Urutan Array (Shuffle)
		function shuffleArray(array) {
			for (let i = array.length - 1; i > 0; i--) {
				const j = Math.floor(Math.random() * (i + 1));
				[array[i], array[j]] = [array[j], array[i]];
			}
		}

		// Buat Link WhatsApp
		function createWALink(contactStr) {
			if (!contactStr) return "#";
			let number = contactStr.replace(/\D/g, ''); 
			if (number.startsWith('0')) {
				number = '62' + number.substring(1);
			}
			return `https://wa.me/${number}`;
		}


		// ==================================================
		// 3. LOGIC: LOGIN / TOKEN GATE
		// ==================================================
		function attemptLogin(role) {
			let inputToken = "";
			let valid = false;

			if (role === 'ikhwan') {
				inputToken = document.getElementById('tokenIkhwan').value;
				if (inputToken === "sakinah354") {
					userTargetGender = "Perempuan";
					valid = true;
					alert("Login Berhasil! Menampilkan biodata Akhwat.");
				}
			} else if (role === 'akhwat') {
				inputToken = document.getElementById('tokenAkhwat').value;
				if (inputToken === "mawaddah313") {
					userTargetGender = "Laki-Laki";
					valid = true;
					alert("Login Berhasil! Menampilkan biodata Ikhwan.");
				}
			} else if (role === 'pnkb') {
				inputToken = document.getElementById('tokenPnkb').value;
				if (inputToken === "warrahmah123" || inputToken === "admin") {
				    userTargetGender = "ALL";
				    valid = true;
				    alert("Login Admin Berhasil! Menampilkan semua data.");
				}
			}

			if (valid) {
				// Buka Gate
				document.getElementById('loginGate').style.display = 'none';
				document.body.classList.remove('locked');
				
				// Atur Filter UI
				resetFilter(); 
				if (userTargetGender !== "ALL") {
					document.getElementById('genderFilter').disabled = true;
					document.getElementById('genderFilter').value = userTargetGender;
				} else {
					document.getElementById('genderFilter').disabled = false;
				}
			} else {
				alert("Token Salah! Silakan coba lagi.");
			}
		}


		// ==================================================
		// 4. LOGIC: RENDER & DISPLAY DATA
		// ==================================================
		function render() {
			const start = (currentPage - 1) * itemsPerPage;
			const end = start + itemsPerPage;
			const currentItems = filteredData.slice(start, end);
			displayBiodata(currentItems);
			buildPagination();
		}

		function displayBiodata(data) {
			const container = document.getElementById('biodataContainer');
			container.innerHTML = "";
			document.getElementById("displayedBiodata").textContent = data.length;

			if (data.length === 0) {
				container.innerHTML = `
					<div class="col-12 text-center py-5">
						<div class="text-muted">
							<i class="fas fa-search fa-3x mb-3"></i>
							<p class="fs-5">Tidak ada biodata yang sesuai dengan pencarian.</p>
							<button class="btn btn-outline-primary btn-sm mt-2" onclick="resetFilter()">Reset Filter</button>
						</div>
					</div>`;
				return;
			}

			data.forEach(person => {
				const rawFoto = person["Foto Diri (Tampak Seluruh Tubuh)"] || "";
				const uniqueID = encodeURIComponent(rawFoto);
				const fotoo = convertDriveLink(rawFoto);
				const colorLabel = person["Kode Warna"] || "Info"; 
				const badgeClass = getColorClass(colorLabel);
				
				const card = document.createElement("div");
				card.className = "col-xl-3 col-lg-4 col-md-6 mb-4";

				card.innerHTML = `
					<div class="card card-biodata h-100">
						<div style="position:relative;">
							<img src="${fotoo}" class="card-img-top" alt="Foto ${person["Nama Inisial"]}" onerror="this.src='https://via.placeholder.com/400x400?text=Error+Img'">
							<span class="badge ${badgeClass}" 
								  style="position:absolute; top:10px; right:10px; font-size: 1.2rem; padding: 10px 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">
								${colorLabel}
							</span>
						</div>
						<div class="card-body d-flex flex-column">
							<h5 class="card-title">${person["Nama Inisial"]}</h5>
							<ul class="biodata-details mb-3 flex-grow-1">
								<li><i class="fas fa-calendar-alt text-muted"></i><strong>TTL : </strong> ${person["Tempat, Tanggal Lahir"]}</li>
								<li><i class="fas fa-map-marker-alt text-muted"></i><strong>Daerah : </strong> ${person["Daerah Sambung"]}</li>
								<li><i class="fas fa-graduation-cap text-muted"></i><strong>Pendidikan : </strong> ${person["Pendidikan Terakhir"]}</li>
								<li><i class="fas fa-briefcase text-muted"></i><strong>Pekerjaan: </strong> ${person["Pekerjaan"]}</li>
							</ul>
							<button class="btn btn-outline-custom mt-auto w-100" onclick="viewDetail('${uniqueID}')">
								<i class="fas fa-eye me-1"></i> Lihat Detail
							</button>
						</div>
					</div>
				`;
				container.appendChild(card);
			});
		}

		function viewDetail(encodedFoto) {
			const realFotoURL = decodeURIComponent(encodedFoto);
			const person = biodata.find(p => (p["Foto Diri (Tampak Seluruh Tubuh)"] || "") === realFotoURL);
			
			if (!person) {
				console.error("Data tidak ditemukan untuk foto:", realFotoURL);
				return;
			}
			
			// Link WA
			const waKelompok = createWALink(person["Nama dan No HP Tim PNKB Kelompok"]);
			const waDaerah = createWALink(person["Nama dan No HP Tim PNKB Daerah"]);

			// Update Foto di Modal
			const imgElement = document.getElementById('detailFoto');
			imgElement.src = convertDriveLink(person["Foto Diri (Tampak Seluruh Tubuh)"]);
			
			// Setup Klik Foto untuk Zoom
			document.getElementById('imageContainerBtn').onclick = function() {
				const viewer = document.getElementById("imageViewer");
				const expandedImg = document.getElementById("expandedImg");
				
				expandedImg.src = imgElement.src;
				viewer.style.display = "flex";
				viewer.style.alignItems = "center";
				viewer.style.justifyContent = "center";
				
				// Reset Zoom
				document.getElementById('zoomSlider').value = 1;
				closeZoom(); // Reset posisi dulu
				document.getElementById("imageViewer").style.display = "flex"; // Buka lagi
			}
			
			// Update Isi Modal
			document.getElementById('detailList').innerHTML = `
				<li class="list-group-item">
					<h4 class="text-primary mb-3">${person["Nama Inisial"]}</h4>
					<span class="badge ${getColorClass(person["Kode Warna"])} mb-2 fs-6">${person["Kode Warna"]}</span>
				</li>
				<li class="list-group-item"><strong>Jenis Kelamin:</strong> ${person["Jenis Kelamin"]}</li>
				<li class="list-group-item"><strong>Status:</strong> ${person["Status Pernikahan"]}</li>
				<li class="list-group-item"><strong>TTL:</strong> ${person["Tempat, Tanggal Lahir"]}</li>
				<li class="list-group-item"><strong>Pekerjaan:</strong> ${person["Pekerjaan"]}</li>
				<li class="list-group-item"><strong>Pendidikan:</strong> ${person["Pendidikan Terakhir"]}</li>
				<li class="list-group-item"><strong>Fisik:</strong> ${person["Tinggi Badan/Berat Badan"]}</li>
				<li class="list-group-item"><strong>Hobi:</strong> ${person["Hobi"]}</li>
				<li class="list-group-item bg-light"><strong>Kriteria Idaman:</strong><br> ${person["Mencari Pasangan yang..."]}</li>
				<li class="list-group-item"><strong>Lokasi:</strong> ${person["Daerah Sambung"]} (${person["Desa Sambung"]} - ${person["Kelompok Sambung"]})</li>
				<li class="list-group-item">
					<strong>Kontak Tim PNKB Kelompok:</strong><br>
					${person["Nama dan No HP Tim PNKB Kelompok"]} 
					<a href="${waKelompok}" target="_blank" class="btn btn-success btn-sm ms-2"><i class="fab fa-whatsapp"></i> Hubungi</a>
				</li>
				<li class="list-group-item">
					<strong>Kontak Tim PNKB Daerah:</strong><br>
					${person["Nama dan No HP Tim PNKB Daerah"]}
					<a href="${waDaerah}" target="_blank" class="btn btn-success btn-sm ms-2"><i class="fab fa-whatsapp"></i> Hubungi</a>
				</li>
			`;

			new bootstrap.Modal(document.getElementById('detailModal')).show();
		}


		// ==================================================
		// 5. LOGIC: SEARCH & FILTER
		// ==================================================
		function searchBiodata() {
			const rawInput = document.getElementById('searchInput').value.toLowerCase();
			const cleanInput = rawInput.replace(/[^a-z0-9]/g, '');

			const gender = document.getElementById('genderFilter').value;
			const lokasi = document.getElementById('locationFilter').value;
			const pendidikan = document.getElementById('educationFilter').value;
			const yearRange = document.getElementById('yearFilter').value;

			if (typeof biodata === 'undefined') return;

			const pendidikanStandar = [
				"SD/Sederajat", "SMP/Sederajat", "SMA/Sederajat", "SMK",
				"D1/D2/D3", "D4", "S1", "S2"
			];

			filteredData = biodata.filter(p => {
				// A. Search Text
				const nama = (p["Nama Inisial"] || "").toLowerCase();
				const daerah = (p["Daerah Sambung"] || "").toLowerCase();
				const pekerjaan = (p["Pekerjaan"] || "").toLowerCase();
				const matchStandard = nama.includes(rawInput) || daerah.includes(rawInput) || pekerjaan.includes(rawInput);

				const kodeWarnaRaw = (p["Kode Warna"] || "").toLowerCase();
				const kodeWarnaClean = kodeWarnaRaw.replace(/[^a-z0-9]/g, ''); 
				const matchWarna = (cleanInput !== "" && kodeWarnaClean.includes(cleanInput));
				
				const matchSearch = matchStandard || matchWarna;

				// B. Filter Logic (Gender + Token)
				let matchGender = true;
				if (typeof userTargetGender !== 'undefined' && userTargetGender !== null && userTargetGender !== "ALL") {
					// KASUS USER BIASA: Ikuti Token
					matchGender = p["Jenis Kelamin"] === userTargetGender;
				} else {
					// KASUS ADMIN: Ikuti Dropdown
					matchGender = gender === "all" || p["Jenis Kelamin"] === gender;
				}

				const matchLocation = lokasi === "all" || p["Daerah Sambung"] === lokasi;
				
				let matchEdu = true;
				if (pendidikan === "others") {
					matchEdu = !pendidikanStandar.includes(p["Pendidikan Terakhir"]);
				} else if (pendidikan !== "all") {
					matchEdu = p["Pendidikan Terakhir"] === pendidikan;
				}

				let matchYear = true;
				const birthYear = extractYear(p["Tempat, Tanggal Lahir"]);
				if (yearRange !== "all") {
					if (birthYear === 0) {
						matchYear = false; 
					} else {
						const [minY, maxY] = yearRange.split("-").map(Number);
						matchYear = birthYear >= minY && birthYear <= maxY;
					}
				}

				return matchSearch && matchGender && matchLocation && matchEdu && matchYear;
			});

			currentPage = 1;
			render();
		}

		function resetFilter() {
			document.getElementById('searchInput').value = '';
			document.getElementById('genderFilter').value = 'all';
			document.getElementById('locationFilter').value = 'all';
			document.getElementById('educationFilter').value = 'all';
			document.getElementById('yearFilter').value = 'all';
			searchBiodata();
		}


		// ==================================================
		// 6. LOGIC: PAGINATION
		// ==================================================
		function buildPagination() {
			const totalPages = Math.ceil(filteredData.length / itemsPerPage);
			const pagination = document.querySelector(".pagination");
			pagination.innerHTML = "";

			if (totalPages <= 1) return;

			pagination.innerHTML += `<li class="page-item ${currentPage === 1 ? 'disabled' : ''}"><button class="page-link" onclick="changePage(${currentPage - 1})">Previous</button></li>`;

			for (let i = 1; i <= totalPages; i++) {
				pagination.innerHTML += `<li class="page-item ${i === currentPage ? 'active' : ''}"><button class="page-link" onclick="changePage(${i})">${i}</button></li>`;
			}

			pagination.innerHTML += `<li class="page-item ${currentPage === totalPages ? 'disabled' : ''}"><button class="page-link" onclick="changePage(${currentPage + 1})">Next</button></li>`;
		}

		function changePage(page) {
			if (page < 1) return;
			currentPage = page;
			render();
			const katalog = document.getElementById('katalog');
			if(katalog) katalog.scrollIntoView({behavior: 'smooth'});
		}


		// ==================================================
		// 7. LOGIC: ZOOM, SLIDER & DRAG
		// ==================================================
		function updateZoom(change) {
			const slider = document.getElementById('zoomSlider');
			let newVal = parseFloat(slider.value) + change;
			if (newVal > slider.max) newVal = slider.max;
			if (newVal < slider.min) newVal = slider.min;
			slider.value = newVal;
			applyTransform(newVal);
		}

		function applyTransform(zoomVal) {
			currentZoom = zoomVal;
			const img = document.getElementById('expandedImg');
			img.style.transform = `scale(${zoomVal}) translate(${translateX}px, ${translateY}px)`;
		}

		function closeZoom() {
			document.getElementById("imageViewer").style.display = "none";
			document.getElementById('zoomSlider').value = 1;
			currentZoom = 1;
			translateX = 0;
			translateY = 0;
			applyTransform(1);
		}


		// ==================================================
		// 8. INITIALIZATION (EVENT LISTENERS)
		// ==================================================
		document.addEventListener("DOMContentLoaded", () => {
			// A. Kunci Scroll (Login Gate)
			document.body.classList.add('locked');

			// B. Load & Shuffle Data
			if (typeof biodata !== 'undefined') {
				shuffleArray(biodata);
				document.getElementById("totalBiodata").textContent = biodata.length;
				document.getElementById("totalBiodata2").textContent = biodata.length;
				render();
			} else {
				console.error("File biodata.js belum dimuat!");
			}

			// C. Filter Events
			document.getElementById('genderFilter').addEventListener("change", searchBiodata);
			document.getElementById('locationFilter').addEventListener("change", searchBiodata);
			document.getElementById('educationFilter').addEventListener("change", searchBiodata);
			document.getElementById('yearFilter').addEventListener("change", searchBiodata); 
			document.getElementById("searchInput").addEventListener("keyup", searchBiodata);
			document.getElementById("itemsPerPage").addEventListener("change", function() {
				itemsPerPage = parseInt(this.value);
				currentPage = 1;
				render();
			});

			// D. Zoom & Drag Events
			const slider = document.getElementById('zoomSlider');
			const viewer = document.getElementById('imageViewer');
			const img = document.getElementById('expandedImg');

			slider.addEventListener('input', function() { applyTransform(this.value); });

			viewer.addEventListener('wheel', function(e) {
				e.preventDefault();
				let change = e.deltaY > 0 ? -0.1 : 0.1;
				updateZoom(change);
			});

			viewer.addEventListener('click', function(e) {
				if (e.target === viewer) closeZoom();
			});

			// Dragging Logic
			img.addEventListener('mousedown', function(e) {
				if (currentZoom <= 1) return; 
				isDragging = true;
				startX = e.clientX - translateX;
				startY = e.clientY - translateY;
				img.style.transition = 'none'; 
			});

			window.addEventListener('mousemove', function(e) {
				if (!isDragging) return;
				translateX = e.clientX - startX;
				translateY = e.clientY - startY;
				applyTransform(currentZoom);
			});

			window.addEventListener('mouseup', function() {
				if (isDragging) {
					isDragging = false;
					img.style.transition = 'transform 0.1s ease-out'; 
				}
			});
		});
	</script>
	
	
</body>
</html>

